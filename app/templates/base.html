<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		{% if title %}
		<title> {{ page.title }} - Outdoor Recreation </title>
		{% else %}
		<title> Welcome to Outdoor Recreation </title>
		{% endif %}
		<link href={{ url_for( 'static', filename='styles/style.css') }} rel=stylesheet type="text/css">
		<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css" />		
		<script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>
		<style>
			{% if activity %}
			header { background: url({{ url_for( 'static', filename='images/' + activity + '.jpg' ) }}) }
			{% endif %}
		</style>
	</head>
<body>

	<header>

	<h1>Ohio Valley Adventures: {{ page.title }} </h1>

	</header>

	<div id="map">

	</div>

	<nav id="activitiesList">

	<ul>

	{% for activity in page.activities %}
		<li class="activity"><a href="{{ url_for('.activity', activity=activity.name) }}">{{ activity.name }}</a></li>
	{% endfor %}

	</ul>

	</nav>	
	
	<div id="directory">
	
	{% block directory %} {% endblock directory %}

	</div>

	<footer>
	
	<p>All data copyright Jesse Messylastname. 

	   Design by <a href="http://www.daydrea.me">daydrea.me</a></p>

	</footer>

	<script>
		{% block mapscript %}

		var map = L.map('map').setView([{{ page.mapCenter.latitude }}, {{ page.mapCenter.longitude }}], 12);

		/*map.locate({setView: true, maxZoom: 16});*/

		L.tileLayer('http://localhost/osm/{z}/{x}/{y}.png', {
    			attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>',
			maxZoom: 18
		}).addTo(map);

		function onLocationFound(e) {
		    var radius = e.accuracy / 2;

		    L.marker(e.latlng).addTo(map)
		        .bindPopup("You are within " + radius + " meters from this point").openPopup();

		    L.circle(e.latlng, radius).addTo(map);
		}

		map.on('locationfound', onLocationFound);
	
		function onLocationError(e) {
		    alert(e.message);
		}

		map.on('locationerror', onLocationError);

		{% for place in places %} 
		var marker = L.marker([{{ place.latitude }}, {{ place.longitude }}]).addTo(map);
		{% endfor %}

		{% endblock %}

	</script>
</body>

</html>
